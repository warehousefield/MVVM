using Autodesk.Revit.DB;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Input;

public class MainViewModel : ObservableObject
{
    private readonly RevitService _revitService;
    
    // Свойство, связанное со списком в ComboBox
    private List<RoofType> _roofTypes;
    public List<RoofType> RoofTypes
    {
        get => _roofTypes;
        set => SetProperty(ref _roofTypes, value);
    }
    
    // Свойство, связанное с выбранным элементом ComboBox
    private RoofType _selectedRoofType;
    public RoofType SelectedRoofType
    {
        get => _selectedRoofType;
        set => SetProperty(ref _selectedRoofType, value);
    }

    // Команда для кнопки "Установить кровлю"
    public ICommand InstallRoofCommand { get; }

    public MainViewModel(RevitService revitService)
    {
        _revitService = revitService;
        
        // Заполняем список типов кровли при инициализации
        RoofTypes = _revitService.GetRoofTypes();
        SelectedRoofType = RoofTypes.FirstOrDefault();
        
        // Привязываем команду к методу в ViewModel
        InstallRoofCommand = new RelayCommand(InstallRoof, CanInstallRoof);
    }

    private void InstallRoof(object parameter)
    {
        _revitService.CreateRoof(SelectedRoofType);
    }

    private bool CanInstallRoof(object parameter)
    {
        return SelectedRoofType != null;
    }
}
